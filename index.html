<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Car vs Zombies - Conduce, derrapa y esquiva hordas de zombies">
  <meta name="theme-color" content="#1a2a36">
  <title>Car vs Zombies â€“ Juego de AcciÃ³n Ultra</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://unpkg.com">
</head>
<body>
  <div id="container" role="main">
    <!-- HUD del juego -->
    <aside id="hud" aria-label="EstadÃ­sticas del juego">
      <div class="stat">
        <div><span class="label">FPS</span></div>
        <div id="fps" style="font-family: monospace;">60</div>
      </div>
      <div class="stat">
        <div><span class="label">PuntuaciÃ³n</span></div>
        <div id="score" aria-live="polite">0</div>
      </div>
      <div class="stat">
        <div><span class="label">Vida</span></div>
        <div id="hp" aria-live="polite">100</div>
      </div>
      <div class="stat">
        <div><span class="label">Velocidad</span></div>
        <div id="speed" aria-live="polite">0 km/h</div>
      </div>
      <div class="stat">
        <div><span class="label">Monedas</span></div>
        <div id="coins" aria-live="polite">0</div>
      </div>
      <div class="stat">
        <div><span class="label">Combo</span></div>
        <div id="combo" style="color: #ff6600; font-weight: bold; display: none;">x1</div>
      </div>
      <div class="stat">
        <div><span class="label">Oleada</span></div>
        <div id="wave">1</div>
      </div>
      <div class="stat">
        <div><span class="label">Arma</span></div>
        <div id="weaponStatus">Sin arma</div>
      </div>
      <div class="stat">
        <div><span class="label">MuniciÃ³n</span></div>
        <div id="ammo">0</div>
      </div>
      <div class="stat">
        <div><span class="label">Modo</span></div>
        <div id="modeDisplay">ClÃ¡sico</div>
      </div>
      <div class="stat">
        <div><span class="label">Tiempo</span></div>
        <div id="timeDisplay">âˆ</div>
      </div>
      <div class="stat" style="width: 100%; margin-top: 8px;">
        <div style="font-size: 11px; color: var(--muted); margin-bottom: 4px;">Nitro</div>
        <div style="width: 100%; height: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden;">
          <div id="nitroBar" style="width: 100%; height: 100%; background: linear-gradient(90deg, #ff6600, #ffdd00); transition: width 0.2s;"></div>
        </div>
      </div>
    </aside>

    <!-- Power-ups activos -->
    <div id="powerupContainer" style="position: absolute; left: 12px; top: 280px; z-index: 40; display: flex; flex-direction: column; gap: 8px;">
      <!-- Los power-ups activos aparecerÃ¡n aquÃ­ -->
    </div>

    <!-- Barra de jefe -->
    <div id="bossBar" aria-label="Vida del jefe" style="display:none;">
      <div class="boss-label">ğŸ‘¹ JEFE</div>
      <div class="boss-bar-track">
        <div id="bossBarFill"></div>
      </div>
    </div>

    <!-- Mini-mapa -->
    <canvas id="minimap" width="140" height="140" 
            style="position: absolute; top: 12px; right: 12px; z-index: 45; 
                   border: 3px solid var(--accent); border-radius: 12px; 
                   background: rgba(10, 14, 20, 0.9); box-shadow: var(--shadow-lg);">
    </canvas>

    <!-- Controles superiores -->
    <nav id="topRight" aria-label="Controles del juego">
      <button class="btn" id="btnSettings" aria-label="Abrir ajustes">
        <span aria-hidden="true">âš™ï¸</span> Ajustes
      </button>
      <button class="btn primary" id="btnOpenMenu" aria-label="Abrir menÃº principal">
        ğŸ“‹ MenÃº
      </button>
      <button class="btn warn" id="btnRestart" style="display:none" aria-label="Reiniciar partida">
        ğŸ”„ Reiniciar
      </button>
    </nav>

    <!-- MENÃš PRINCIPAL -->
    <section id="overlayMenu" class="overlay" role="dialog" aria-labelledby="menuTitle" aria-modal="true">
      <h1 id="menuTitle">ğŸš— Car vs Zombies ULTRA</h1>
      <p class="subtitle">
        Conduce, derrapa y esquiva hordas de zombies.<br>
        Â¡Power-ups, armas y mejoras permanentes!
      </p>

      <div class="mode-selector" aria-label="Selector de modo de juego">
        <h2>ğŸ® Modos de juego</h2>
        <div class="mode-grid">
          <button class="mode-card selected" data-mode="classic">
            <h3>ClÃ¡sico</h3>
            <p>Oleadas infinitas, equilibrio estÃ¡ndar.</p>
            <span class="mode-tag">Recomendado</span>
          </button>
          <button class="mode-card" data-mode="timeAttack">
            <h3>Contrarreloj</h3>
            <p>120 segundos para puntuar lo mÃ¡ximo.</p>
            <span class="mode-tag">Score x1.3</span>
          </button>
          <button class="mode-card" data-mode="survival">
            <h3>Supervivencia</h3>
            <p>MÃ¡s daÃ±o, menos power-ups. Â¿CuÃ¡nto aguantas?</p>
            <span class="mode-tag danger">Hardcore</span>
          </button>
        </div>
      </div>
      
      <div class="menu-actions">
        <button class="btn primary large" id="startBtn">
          â–¶ï¸ Empezar Partida
        </button>
        <button class="btn large" id="openShop">
          ğŸ›’ Tienda & Mejoras
        </button>
        <button class="btn large" id="openZombieInfo">
          ğŸ§Ÿ InformaciÃ³n de Zombies
        </button>
        <button class="btn large" id="openLeaderboard">
          ğŸ† ClasificaciÃ³n
        </button>
        <button class="btn large" id="openTutorial">
          ğŸ“ Tutorial interactivo
        </button>
        <button class="btn large" id="openSettings">
          âš™ï¸ Ajustes
        </button>
      </div>
      
      <div class="controls-info">
        <strong>Controles:</strong>
        <ul class="controls-list">
          <li><kbd>WASD</kbd> o <kbd>Flechas</kbd> â€“ Movimiento</li>
          <li><kbd>RatÃ³n</kbd> â€“ DirecciÃ³n</li>
          <li><kbd>Espacio</kbd> â€“ Freno/Derrape</li>
          <li><kbd>Shift</kbd> â€“ Freno de mano</li>
          <li><kbd>N</kbd> â€“ Nitro (se recarga)</li>
          <li><kbd>E</kbd> o <kbd>Click</kbd> â€“ Disparar (con arma)</li>
          <li><kbd>Q</kbd> â€“ Cambiar arma</li>
        </ul>
      </div>
      
      <div class="game-tips">
        <strong>ğŸ’¡ Tips:</strong>
        <ul class="controls-list">
          <li>MantÃ©n el combo alto para mÃ¡s puntos</li>
          <li>Los zombies tanque (rojos) tienen 3 vidas</li>
          <li>Â¡Cuidado con los zombies amarillos, explotan!</li>
          <li>Invierte en mejoras permanentes</li>
        </ul>
      </div>
    </section>

    <!-- TIENDA DE COLORES Y MEJORAS -->
    <section id="overlayShop" class="overlay shop-overlay" style="display:none" role="dialog" aria-labelledby="shopTitle" aria-modal="true">
      <h1 id="shopTitle">ğŸ›’ Tienda & Mejoras</h1>
      
      <div class="shop-balance">
        <p>
          <strong>ğŸ’° Tus Monedas:</strong>
          <span id="shopCoinsDisplay" class="coins-amount">0</span>
        </p>
      </div>

      <h2 style="margin-top: 16px; font-size: 18px; color: var(--accent);">ğŸ¨ Colores</h2>
      <div id="shopGrid" class="shop-grid" role="list" aria-label="Colores disponibles">
        <!-- Los colores se generan dinÃ¡micamente aquÃ­ -->
      </div>

      <h2 style="margin-top: 24px; font-size: 18px; color: var(--accent);">â¬†ï¸ Mejoras Permanentes</h2>
      <p style="font-size: 13px; color: var(--muted); margin-bottom: 12px;">
        Las mejoras son permanentes y se aplican a todas tus partidas
      </p>
      <div id="upgradesGrid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 12px; margin: 16px 0;">
        <!-- Las mejoras se generan dinÃ¡micamente aquÃ­ -->
      </div>

      <div class="shop-actions">
        <button class="btn large" id="backFromShop">
          â—€ï¸ Volver al MenÃº
        </button>
      </div>
    </section>

    <!-- INFORMACIÃ“N DE ZOMBIES -->
    <section id="overlayZombieInfo" class="overlay" style="display:none; max-width: 700px;" role="dialog" aria-labelledby="zombieInfoTitle" aria-modal="true">
      <h1 id="zombieInfoTitle">ğŸ§Ÿ Tipos de Zombies</h1>
      
      <p style="color: var(--muted); font-size: 14px; margin-bottom: 20px;">
        Conoce a tus enemigos y sus caracterÃ­sticas
      </p>

      <div class="zombie-info-grid">
        <!-- Zombie Normal -->
        <div class="zombie-info-card" style="border-color: #2d5a2d;">
          <div class="zombie-icon" style="background: #2d5a2d;">ğŸ§Ÿ</div>
          <h3 style="color: #2d5a2d;">Zombie Normal</h3>
          <div class="zombie-stats">
            <div class="stat-row">
              <span class="stat-label">Velocidad:</span>
              <span class="stat-value">â­â­â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Vida:</span>
              <span class="stat-value">â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">DaÃ±o:</span>
              <span class="stat-value">12 HP</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Puntos:</span>
              <span class="stat-value">10 pts</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Monedas:</span>
              <span class="stat-value">ğŸ’° 1</span>
            </div>
          </div>
          <p class="zombie-desc">
            El zombie estÃ¡ndar. Velocidad y daÃ±o moderados. Perfecto para practicar combos.
          </p>
        </div>

        <!-- Zombie RÃ¡pido -->
        <div class="zombie-info-card" style="border-color: #ff6600;">
          <div class="zombie-icon" style="background: #ff6600;">ğŸ§Ÿâ€â™‚ï¸</div>
          <h3 style="color: #ff6600;">Zombie RÃ¡pido</h3>
          <div class="zombie-stats">
            <div class="stat-row">
              <span class="stat-label">Velocidad:</span>
              <span class="stat-value">â­â­â­â­â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Vida:</span>
              <span class="stat-value">â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">DaÃ±o:</span>
              <span class="stat-value">8 HP</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Puntos:</span>
              <span class="stat-value">20 pts</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Monedas:</span>
              <span class="stat-value">ğŸ’° 2</span>
            </div>
          </div>
          <p class="zombie-desc">
            Â¡Muy veloz! DifÃ­cil de esquivar pero hace menos daÃ±o. Vale el doble de puntos.
          </p>
        </div>

        <!-- Zombie Tanque -->
        <div class="zombie-info-card" style="border-color: #8b0000;">
          <div class="zombie-icon" style="background: #8b0000;">ğŸ§Ÿâ€â™‚ï¸</div>
          <h3 style="color: #8b0000;">Zombie Tanque</h3>
          <div class="zombie-stats">
            <div class="stat-row">
              <span class="stat-label">Velocidad:</span>
              <span class="stat-value">â­â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Vida:</span>
              <span class="stat-value">â­â­â­ (3 golpes)</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">DaÃ±o:</span>
              <span class="stat-value">25 HP</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Puntos:</span>
              <span class="stat-value">50 pts</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Monedas:</span>
              <span class="stat-value">ğŸ’° 5</span>
            </div>
          </div>
          <p class="zombie-desc">
            <strong>Â¡PELIGROSO!</strong> Lento pero resistente. Necesita 3 golpes para morir. Hace mucho daÃ±o.
          </p>
        </div>

        <!-- Zombie Explosivo -->
        <div class="zombie-info-card" style="border-color: #ffff00;">
          <div class="zombie-icon" style="background: #ffff00; color: #000;">ğŸ’£</div>
          <h3 style="color: #ffff00;">Zombie Explosivo</h3>
          <div class="zombie-stats">
            <div class="stat-row">
              <span class="stat-label">Velocidad:</span>
              <span class="stat-value">â­â­â­â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Vida:</span>
              <span class="stat-value">â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">DaÃ±o:</span>
              <span class="stat-value">30 HP</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Puntos:</span>
              <span class="stat-value">40 pts</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Monedas:</span>
              <span class="stat-value">ğŸ’° 3</span>
            </div>
          </div>
          <p class="zombie-desc">
            <strong>âš ï¸ Â¡CUIDADO!</strong> Explota al morir o al chocar. MantÃ©n tu distancia o usa el escudo.
          </p>
        </div>

        <!-- Zombie Escupidor -->
        <div class="zombie-info-card" style="border-color: #55ddff;">
          <div class="zombie-icon" style="background: #55ddff; color: #000;">ğŸ§ª</div>
          <h3 style="color: #55ddff;">Zombie Escupidor</h3>
          <div class="zombie-stats">
            <div class="stat-row">
              <span class="stat-label">Velocidad:</span>
              <span class="stat-value">â­â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Vida:</span>
              <span class="stat-value">â­â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">DaÃ±o:</span>
              <span class="stat-value">10 HP</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Puntos:</span>
              <span class="stat-value">30 pts</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Monedas:</span>
              <span class="stat-value">ğŸ’° 3</span>
            </div>
          </div>
          <p class="zombie-desc">
            Ataca a distancia con proyectiles tÃ³xicos. Evita quedarte quieto.
          </p>
        </div>

        <!-- Zombie Acechador -->
        <div class="zombie-info-card" style="border-color: #7d2eff;">
          <div class="zombie-icon" style="background: #7d2eff;">ğŸ‘ï¸</div>
          <h3 style="color: #7d2eff;">Zombie Acechador</h3>
          <div class="zombie-stats">
            <div class="stat-row">
              <span class="stat-label">Velocidad:</span>
              <span class="stat-value">â­â­â­â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Vida:</span>
              <span class="stat-value">â­â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">DaÃ±o:</span>
              <span class="stat-value">14 HP</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Puntos:</span>
              <span class="stat-value">35 pts</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Monedas:</span>
              <span class="stat-value">ğŸ’° 4</span>
            </div>
          </div>
          <p class="zombie-desc">
            Se camufla al acercarse. MantÃ©n distancia y vigila el minimapa.
          </p>
        </div>
      </div>

      <div class="zombie-tips">
        <h3>ğŸ’¡ Consejos de Combate</h3>
        <ul>
          <li><strong>Zombies Normales:</strong> Ãšsalos para mantener tu combo alto</li>
          <li><strong>Zombies RÃ¡pidos:</strong> Prioriza esquivarlos, valen muchos puntos</li>
          <li><strong>Zombies Tanque:</strong> Usa el arma o evÃ­talos si no tienes escudo</li>
          <li><strong>Zombies Explosivos:</strong> Â¡NUNCA los mates de frente! Usa el arma desde lejos</li>
          <li><strong>Zombies Escupidores:</strong> MuÃ©vete en zig-zag para esquivar sus proyectiles</li>
          <li><strong>Zombies Acechadores:</strong> Usa el minimapa y mantÃ©n la distancia</li>
        </ul>
      </div>

      <div class="shop-actions">
        <button class="btn large" id="backFromZombieInfo">
          â—€ï¸ Volver al MenÃº
        </button>
      </div>
    </section>

    <!-- TABLA DE CLASIFICACIÃ“N -->
    <section id="overlayLeaderboard" class="overlay" style="display:none; max-width: 600px;" role="dialog" aria-labelledby="leaderboardTitle" aria-modal="true">
      <h1 id="leaderboardTitle">ğŸ† Tabla de ClasificaciÃ³n</h1>
      
      <p style="color: var(--muted); font-size: 14px; margin-bottom: 20px;">
        Top 10 mejores puntuaciones
      </p>

      <div id="leaderboardContent" style="min-height: 300px;">
        <!-- Las entradas se generan dinÃ¡micamente -->
      </div>

      <div class="shop-actions">
        <button class="btn large" id="backFromLeaderboard">
          â—€ï¸ Volver al MenÃº
        </button>
      </div>
    </section>

    <!-- TUTORIAL INTERACTIVO -->
    <section id="overlayTutorial" class="overlay" style="display:none; max-width: 700px;" role="dialog" aria-labelledby="tutorialTitle" aria-modal="true">
      <h1 id="tutorialTitle">ğŸ“ Tutorial Interactivo</h1>
      <p style="color: var(--muted); font-size: 14px; margin-bottom: 20px;">
        Completa los pasos para dominar el juego.
      </p>
      <ol id="tutorialSteps" class="tutorial-steps">
        <!-- Pasos dinÃ¡micos -->
      </ol>
      <div class="shop-actions">
        <button class="btn primary large" id="startTutorial">
          â–¶ï¸ Iniciar Tutorial
        </button>
        <button class="btn large" id="backFromTutorial">
          â—€ï¸ Volver al MenÃº
        </button>
      </div>
    </section>

    <!-- GAME OVER -->
    <section id="overlayGameOver" class="overlay" style="display:none" role="dialog" aria-labelledby="goTitle" aria-modal="true">
      <h1 id="goTitle">Game Over</h1>
      
      <div class="game-over-stats">
        <p class="final-score">
          PuntuaciÃ³n final: <strong id="goScore">0</strong>
        </p>
        <p class="coins-earned">
          ğŸ’° Monedas ganadas: <strong id="goCoins">0</strong>
        </p>
        <p style="color: var(--muted); font-size: 14px;">
          ğŸ¯ Kills totales: <strong id="goKills" style="color: #ff6600;">0</strong>
        </p>
        <p style="color: var(--muted); font-size: 14px;">
          ğŸ”¥ Combo mÃ¡ximo: <strong id="goMaxCombo" style="color: #ff6600;">x1</strong>
        </p>
        <p style="color: var(--muted); font-size: 14px;">
          â±ï¸ Tiempo sobrevivido: <strong id="goTime" style="color: #ff6600;">0s</strong>
        </p>
        <p style="color: var(--muted); font-size: 14px;">
          ğŸï¸ Velocidad mÃ¡xima: <strong id="goTopSpeed" style="color: #ff6600;">0 km/h</strong>
        </p>
        <p style="color: var(--muted); font-size: 14px;">
          ğŸ¯ PrecisiÃ³n: <strong id="goAccuracy" style="color: #ff6600;">0%</strong>
        </p>
      </div>
      
      <div class="game-over-actions">
        <button class="btn primary large" id="playAgain">
          ğŸ”„ Jugar otra vez
        </button>
        <button class="btn large" id="toMenu">
          ğŸ“‹ Volver al menÃº
        </button>
      </div>
    </section>

    <!-- PANEL DE AJUSTES -->
    <aside id="settingsPanel" role="dialog" aria-labelledby="settingsTitle" style="display:none">
      <h3 id="settingsTitle">âš™ï¸ Ajustes</h3>
      
      <div class="settings-group">
        <div class="setting">
          <label for="volMaster">
            ğŸ”Š Volumen maestro
            <span id="volMasterVal" class="setting-value">80%</span>
          </label>
          <input 
            id="volMaster" 
            type="range" 
            min="0" 
            max="1" 
            step="0.01" 
            value="0.8"
            aria-valuemin="0"
            aria-valuemax="100"
            aria-valuenow="80">
        </div>
        
        <div class="setting">
          <label for="volEngine">
            ğŸï¸ Volumen motor
            <span id="volEngineVal" class="setting-value">80%</span>
          </label>
          <input 
            id="volEngine" 
            type="range" 
            min="0" 
            max="1" 
            step="0.01" 
            value="0.8"
            aria-valuemin="0"
            aria-valuemax="100"
            aria-valuenow="80">
        </div>
        
        <div class="setting">
          <label for="volSfx">
            ğŸ’¥ Volumen efectos
            <span id="volSfxVal" class="setting-value">90%</span>
          </label>
          <input 
            id="volSfx" 
            type="range" 
            min="0" 
            max="1" 
            step="0.01" 
            value="0.9"
            aria-valuemin="0"
            aria-valuemax="100"
            aria-valuenow="90">
        </div>
        
        <div class="setting">
          <label for="mouseSensitivity">
            ğŸ–±ï¸ Sensibilidad del ratÃ³n
            <span id="mouseSensitivityVal" class="setting-value">100%</span>
          </label>
          <input 
            id="mouseSensitivity" 
            type="range" 
            min="0.1" 
            max="2" 
            step="0.1" 
            value="1"
            aria-valuemin="10"
            aria-valuemax="200"
            aria-valuenow="100">
        </div>
      </div>
      
      <div class="settings-actions">
        <button class="btn" id="closeSettings">Cerrar</button>
      </div>
    </aside>

    <!-- Mensaje flotante en juego -->
    <div id="inGameMsg" role="status" aria-live="polite"></div>

    <!-- Controles tÃ¡ctiles -->
    <div id="touchControls" aria-hidden="true">
      <div id="joystickLeft" class="joystick">
        <div class="joystick-base"></div>
        <div class="joystick-stick"></div>
      </div>
      <div id="joystickRight" class="joystick">
        <div class="joystick-base"></div>
        <div class="joystick-stick"></div>
      </div>
    </div>

    <!-- Footer informativo -->
    <footer id="footer">
      ğŸ’» Mejor experiencia en desktop â€¢ <kbd>F12</kbd> para consola â€¢ 
      <strong style="color: var(--accent);">ULTRA VERSION</strong>
    </footer>
  </div>

  <!-- Three.js y dependencias -->
  <script src="https://unpkg.com/three@0.152.2/build/three.min.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/loaders/GLTFLoader.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/postprocessing/EffectComposer.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/postprocessing/RenderPass.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/postprocessing/UnrealBloomPass.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/postprocessing/ShaderPass.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/shaders/FXAAShader.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/postprocessing/FilmPass.js"></script>
  
  <!-- AplicaciÃ³n principal ULTRA -->
  <script src="app.js"></script>
</body>
</html>
