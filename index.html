<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Car vs Zombies - Conduce, derrapa y esquiva hordas de zombies">
  <meta name="theme-color" content="#1a2a36">
  <title>Car vs Zombies â€“ Juego de AcciÃ³n Ultra</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://unpkg.com">
</head>
<body>
  <div id="container" role="main">
    <!-- Fondo animado de partÃ­culas -->
    <canvas id="bgCanvas" class="bg-canvas"></canvas>
    
    <!-- HUD del juego -->
    <aside id="hud" aria-label="EstadÃ­sticas del juego">
      <div class="stat">
        <div><span class="label">FPS</span></div>
        <div id="fps" style="font-family: monospace;">60</div>
      </div>
      <div class="stat">
        <div><span class="label">PuntuaciÃ³n</span></div>
        <div id="score" aria-live="polite">0</div>
      </div>
      <div class="stat">
        <div><span class="label">Vida</span></div>
        <div id="hp" aria-live="polite">100</div>
      </div>
      <div class="stat">
        <div><span class="label">Velocidad</span></div>
        <div id="speed" aria-live="polite">0 km/h</div>
      </div>
      <div class="stat">
        <div><span class="label">Monedas</span></div>
        <div id="coins" aria-live="polite">0</div>
      </div>
      <div class="stat">
        <div><span class="label">Combo</span></div>
        <div id="combo" style="color: #ff6600; font-weight: bold; display: none;">x1</div>
      </div>
      <div class="stat">
        <div><span class="label">Oleada</span></div>
        <div id="wave">1</div>
      </div>
      <div class="stat">
        <div><span class="label">MisiÃ³n</span></div>
        <div id="mission" class="mission-text">-</div>
      </div>
      <div class="stat nitro-stat">
        <div class="nitro-label">Nitro</div>
        <div class="nitro-track">
          <div id="nitroBar" class="nitro-bar"></div>
        </div>
      </div>
    </aside>

    <!-- Power-ups activos -->
    <div id="powerupContainer" class="powerup-container">
      <!-- Los power-ups activos aparecerÃ¡n aquÃ­ -->
    </div>

    <!-- Mini-mapa (Inferior Derecha) -->
    <canvas id="minimap" width="160" height="160" 
            style="position: absolute; bottom: 12px; right: 12px; z-index: 45; 
                   border: 3px solid var(--accent); border-radius: 12px; 
                   background: rgba(10, 14, 20, 0.95); box-shadow: var(--shadow-lg);">
    </canvas>

    <!-- Controles superiores -->
    <nav id="topRight" aria-label="Controles del juego">
      <button class="btn" id="btnSettings" aria-label="Abrir ajustes">
        <span aria-hidden="true">âš™ï¸</span> Ajustes
      </button>
      <button class="btn primary" id="btnOpenMenu" aria-label="Abrir menÃº principal">
        ğŸ“‹ MenÃº
      </button>
      <button class="btn warn" id="btnRestart" style="display:none" aria-label="Reiniciar partida">
        ğŸ”„ Reiniciar
      </button>
    </nav>

    <!-- MENÃš PRINCIPAL MEJORADO -->
    <section id="overlayMenu" class="overlay hero-menu" role="dialog" aria-labelledby="menuTitle" aria-modal="true">
      <!-- Efecto de fondo con lÃ­neas de carretera -->
      <div class="road-lines"></div>
      
      <div class="hero-content">
        <!-- Logo del juego con efecto neÃ³n -->
        <div class="game-logo">
          <div class="logo-icon">ğŸš—</div>
          <h1 id="menuTitle" class="neon-text">
            CAR VS ZOMBIES
            <span class="ultra-badge">ULTRA</span>
          </h1>
          <p class="tagline">
            <span class="typing-text">Conduce, derrapa y sobrevive...</span>
          </p>
        </div>

        <!-- EstadÃ­sticas rÃ¡pidas -->
        <div class="quick-stats">
          <div class="stat-card">
            <div class="stat-icon">ğŸ†</div>
            <div class="stat-value" id="menuBestScore">0</div>
            <div class="stat-label">RÃ©cord</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">ğŸ’°</div>
            <div class="stat-value" id="menuCoins">0</div>
            <div class="stat-label">Monedas</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">ğŸ®</div>
            <div class="stat-value" id="menuGames">0</div>
            <div class="stat-label">Partidas</div>
          </div>
        </div>
        
        <!-- Botones principales con efectos -->
        <div class="menu-actions">
          <button class="btn-hero primary pulse" id="startBtn">
            <span class="btn-icon">â–¶ï¸</span>
            <span class="btn-text">EMPEZAR PARTIDA</span>
            <span class="btn-glow"></span>
          </button>
          
          <div class="menu-grid">
            <button class="btn-hero secondary" id="openShop">
              <span class="btn-icon">ğŸ›’</span>
              <span class="btn-text">Tienda</span>
            </button>
            <button class="btn-hero secondary" id="openZombieInfo">
              <span class="btn-icon">ğŸ§Ÿ</span>
              <span class="btn-text">Zombies</span>
            </button>
            <button class="btn-hero secondary" id="openLeaderboard">
              <span class="btn-icon">ğŸ†</span>
              <span class="btn-text">Records</span>
            </button>
            <button class="btn-hero secondary" id="openSettings">
              <span class="btn-icon">âš™ï¸</span>
              <span class="btn-text">Ajustes</span>
            </button>
            <button class="btn-hero secondary" id="openTutorial">
              <span class="btn-icon">ğŸ“˜</span>
              <span class="btn-text">Tutorial</span>
            </button>
          </div>
        </div>
        
        <!-- Controles compactos -->
        <div class="controls-compact">
          <div class="control-tip">
            <kbd>WASD</kbd> <span>Movimiento</span>
          </div>
          <div class="control-tip">
            <kbd>MOUSE</kbd> <span>DirecciÃ³n</span>
          </div>
          <div class="control-tip">
            <kbd>SHIFT</kbd> <span>Drift</span>
          </div>
          <div class="control-tip">
            <kbd>N</kbd> <span>Nitro</span>
          </div>
        </div>


        <div class="daily-mission-card" id="dailyMissionCard">
          <h3>ğŸ“… MisiÃ³n diaria</h3>
          <p id="dailyMissionText">-</p>
          <button class="btn primary" id="claimDailyMission" disabled>Reclamar recompensa</button>
        </div>

        <!-- Footer con versiÃ³n -->
        <div class="menu-footer">
          <div class="version">Version ULTRA v2.0</div>
          <div class="credit">ğŸ® Mejor en Desktop â€¢ <kbd>F11</kbd> Pantalla Completa</div>
        </div>
      </div>
    </section>

    <!-- TIENDA DE COLORES Y MEJORAS -->
    <section id="overlayShop" class="overlay shop-overlay" style="display:none" role="dialog" aria-labelledby="shopTitle" aria-modal="true">
      <h1 id="shopTitle">ğŸ›’ Tienda & Mejoras</h1>
      
      <div class="shop-balance">
        <p>
          <strong>ğŸ’° Tus Monedas:</strong>
          <span id="shopCoinsDisplay" class="coins-amount">0</span>
        </p>
      </div>

      <h2 style="margin-top: 16px; font-size: 18px; color: var(--accent);">ğŸ¨ Colores</h2>
      <div id="shopGrid" class="shop-grid" role="list" aria-label="Colores disponibles">
        <!-- Los colores se generan dinÃ¡micamente aquÃ­ -->
      </div>

      <h2 style="margin-top: 24px; font-size: 18px; color: var(--accent);">â¬†ï¸ Mejoras Permanentes</h2>
      <p style="font-size: 13px; color: var(--muted); margin-bottom: 12px;">
        Las mejoras son permanentes y se aplican a todas tus partidas
      </p>
      <div id="upgradesGrid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 12px; margin: 16px 0;">
        <!-- Las mejoras se generan dinÃ¡micamente aquÃ­ -->
      </div>


      <h2 style="margin-top: 24px; font-size: 18px; color: var(--accent);">ğŸ§© Estilo del Coche</h2>
      <p style="font-size: 13px; color: var(--muted); margin-bottom: 10px;">Skins temÃ¡ticas, llantas, neones y alerones con rareza.</p>
      <div id="cosmeticsGrid" style="display:grid; grid-template-columns: repeat(auto-fit, minmax(190px, 1fr)); gap: 10px;"></div>

      <h2 style="margin-top: 20px; font-size: 18px; color: var(--accent);">ğŸ”¥ Ofertas rotativas</h2>
      <div id="featuredOffers" style="display:grid; grid-template-columns: repeat(auto-fit, minmax(190px, 1fr)); gap: 10px;"></div>

      <div class="daily-mission-card" style="margin-top: 14px;">
        <h3>ğŸ Caja cosmÃ©tica (monedas)</h3>
        <p>Consigue un cosmÃ©tico aleatorio que no tengas.</p>
        <button class="btn" id="buyCosmeticBox">Abrir caja (450 monedas)</button>
      </div>

      <div class="daily-mission-card" id="shopPreviewCard" style="margin-top: 14px;">
        <h3>ğŸ” ComparaciÃ³n antes/despuÃ©s</h3>
        <p id="shopPreviewText">Selecciona un artÃ­culo para comparar con tu equipamiento actual.</p>
      </div>

      <div class="daily-mission-card" id="manufacturerMissionCard" style="margin-top: 14px;">
        <h3>ğŸ MisiÃ³n del fabricante</h3>
        <p id="manufacturerMissionText">-</p>
      </div>

      <div class="daily-mission-card" id="purchaseHistoryCard" style="margin-top: 14px;">
        <h3>ğŸ§¾ Historial de compras</h3>
        <p id="purchaseHistoryText">Sin compras recientes.</p>
      </div>
      <div class="shop-actions">
        <button class="btn large" id="backFromShop">
          â—€ï¸ Volver al MenÃº
        </button>
      </div>
    </section>

    <!-- INFORMACIÃ“N DE ZOMBIES -->
    <section id="overlayZombieInfo" class="overlay" style="display:none; max-width: 700px;" role="dialog" aria-labelledby="zombieInfoTitle" aria-modal="true">
      <h1 id="zombieInfoTitle">ğŸ§Ÿ Tipos de Zombies</h1>
      
      <p style="color: var(--muted); font-size: 14px; margin-bottom: 20px;">
        Conoce a tus enemigos y sus caracterÃ­sticas
      </p>

      <div class="zombie-info-grid">
        <!-- Zombie Normal -->
        <div class="zombie-info-card" style="border-color: #2d5a2d;">
          <div class="zombie-icon" style="background: #2d5a2d;">ğŸ§Ÿ</div>
          <h3 style="color: #2d5a2d;">Zombie Normal</h3>
          <div class="zombie-stats">
            <div class="stat-row">
              <span class="stat-label">Velocidad:</span>
              <span class="stat-value">â­â­â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Vida:</span>
              <span class="stat-value">â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">DaÃ±o:</span>
              <span class="stat-value">12 HP</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Puntos:</span>
              <span class="stat-value">10 pts</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Monedas:</span>
              <span class="stat-value">ğŸ’° 1</span>
            </div>
          </div>
          <p class="zombie-desc">
            El zombie estÃ¡ndar. Velocidad y daÃ±o moderados. Perfecto para practicar combos.
          </p>
        </div>

        <!-- Zombie RÃ¡pido -->
        <div class="zombie-info-card" style="border-color: #ff6600;">
          <div class="zombie-icon" style="background: #ff6600;">ğŸ§Ÿâ€â™‚ï¸</div>
          <h3 style="color: #ff6600;">Zombie RÃ¡pido</h3>
          <div class="zombie-stats">
            <div class="stat-row">
              <span class="stat-label">Velocidad:</span>
              <span class="stat-value">â­â­â­â­â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Vida:</span>
              <span class="stat-value">â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">DaÃ±o:</span>
              <span class="stat-value">8 HP</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Puntos:</span>
              <span class="stat-value">20 pts</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Monedas:</span>
              <span class="stat-value">ğŸ’° 2</span>
            </div>
          </div>
          <p class="zombie-desc">
            Muy rÃ¡pido pero frÃ¡gil. DifÃ­cil de alcanzar, pero vale mÃ¡s puntos.
          </p>
        </div>

        <!-- Zombie Tanque -->
        <div class="zombie-info-card" style="border-color: #8b0000;">
          <div class="zombie-icon" style="background: #8b0000;">ğŸ§Ÿâ€â™€ï¸</div>
          <h3 style="color: #8b0000;">Zombie Tanque</h3>
          <div class="zombie-stats">
            <div class="stat-row">
              <span class="stat-label">Velocidad:</span>
              <span class="stat-value">â­â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Vida:</span>
              <span class="stat-value">â­â­â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">DaÃ±o:</span>
              <span class="stat-value">25 HP</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Puntos:</span>
              <span class="stat-value">50 pts</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Monedas:</span>
              <span class="stat-value">ğŸ’° 5</span>
            </div>
          </div>
          <p class="zombie-desc">
            <strong>Â¡PELIGROSO!</strong> Lento pero resistente. Necesita 3 golpes para morir. Hace mucho daÃ±o.
          </p>
        </div>

        <!-- Zombie Explosivo -->
        <div class="zombie-info-card" style="border-color: #ffff00;">
          <div class="zombie-icon" style="background: #ffff00; color: #000;">ğŸ’£</div>
          <h3 style="color: #ffff00;">Zombie Explosivo</h3>
          <div class="zombie-stats">
            <div class="stat-row">
              <span class="stat-label">Velocidad:</span>
              <span class="stat-value">â­â­â­â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Vida:</span>
              <span class="stat-value">â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">DaÃ±o:</span>
              <span class="stat-value">30 HP</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Puntos:</span>
              <span class="stat-value">40 pts</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Monedas:</span>
              <span class="stat-value">ğŸ’° 3</span>
            </div>
          </div>
          <p class="zombie-desc">
            <strong>âš ï¸ Â¡CUIDADO!</strong> Explota al morir o al chocar. MantÃ©n tu distancia o usa el escudo.
          </p>
        </div>
      </div>

      <div class="zombie-tips">
        <h3>ğŸ’¡ Consejos de Combate</h3>
        <ul>
          <li><strong>Zombies Normales:</strong> Ãšsalos para mantener tu combo alto</li>
          <li><strong>Zombies RÃ¡pidos:</strong> Prioriza esquivarlos, valen muchos puntos</li>
          <li><strong>Zombies Tanque:</strong> Usa el arma o evÃ­talos si no tienes escudo</li>
          <li><strong>Zombies Explosivos:</strong> Â¡NUNCA los mates de frente! Usa el arma desde lejos</li>
        </ul>
      </div>

      <div class="shop-actions">
        <button class="btn large" id="backFromZombieInfo">
          â—€ï¸ Volver al MenÃº
        </button>
      </div>
    </section>

    <!-- TABLA DE CLASIFICACIÃ“N -->
    <section id="overlayLeaderboard" class="overlay" style="display:none; max-width: 700px;" role="dialog" aria-labelledby="leaderboardTitle" aria-modal="true">
      <h1 id="leaderboardTitle">ğŸ† Tabla de ClasificaciÃ³n</h1>
      
      <p style="color: var(--muted); font-size: 14px; margin-bottom: 12px;">
        Top 10 mejores puntuaciones con detalles de partida
      </p>

      <div id="leaderboardSummary" class="leaderboard-summary"></div>

      <div class="leaderboard-controls">
        <button class="btn" id="sortByScore">Score</button>
        <button class="btn" id="sortByKills">Kills</button>
        <button class="btn" id="sortByWave">Oleada</button>
      </div>

      <div id="leaderboardAchievements" class="leaderboard-achievements"></div>

      <div id="leaderboardContent" style="min-height: 260px;">
        <!-- Las entradas se generan dinÃ¡micamente -->
      </div>

      <div class="shop-actions" style="display:flex; gap:10px; flex-wrap:wrap; justify-content:center;">
        <button class="btn warn" id="clearLeaderboard">ğŸ§¹ Limpiar rÃ©cords</button>
        <button class="btn large" id="backFromLeaderboard">
          â—€ï¸ Volver al MenÃº
        </button>
      </div>
    </section>


    <!-- TUTORIAL INTERACTIVO -->
    <section id="overlayTutorial" class="overlay" style="display:none; max-width: 760px;" role="dialog" aria-labelledby="tutorialTitle" aria-modal="true">
      <h1 id="tutorialTitle">ğŸ“˜ Tutorial interactivo</h1>
      <p style="color: var(--muted); font-size: 14px;">Aprende lo esencial en 3 pasos para dominar coche, nitro y combate.</p>

      <div class="daily-mission-card">
        <h3 id="tutorialStepTitle">Paso 1</h3>
        <p id="tutorialStepText">Pulsa Shift mientras giras para derrapar.</p>
      </div>

      <div class="shop-actions" style="display:flex; gap:10px; flex-wrap:wrap; justify-content:center;">
        <button class="btn primary large" id="startTutorialRun">â–¶ï¸ Iniciar tutorial</button>
        <button class="btn large" id="nextTutorialStep">Siguiente paso</button>
        <button class="btn" id="backFromTutorial">â—€ï¸ Volver al menÃº</button>
      </div>
    </section>

    <!-- GAME OVER -->
    <section id="overlayGameOver" class="overlay" style="display:none" role="dialog" aria-labelledby="goTitle" aria-modal="true">
      <h1 id="goTitle">Game Over</h1>
      
      <div class="game-over-stats">
        <p class="final-score">
          PuntuaciÃ³n final: <strong id="goScore">0</strong>
        </p>
        <p class="coins-earned">
          ğŸ’° Monedas ganadas: <strong id="goCoins">0</strong>
        </p>
        <p style="color: var(--muted); font-size: 14px;">
          ğŸ¯ Kills totales: <strong id="goKills" style="color: #ff6600;">0</strong>
        </p>
        <p style="color: var(--muted); font-size: 14px;">
          ğŸ”¥ Combo mÃ¡ximo: <strong id="goMaxCombo" style="color: #ff6600;">x1</strong>
        </p>
      </div>
      
      <div class="game-over-actions">
        <button class="btn primary large" id="playAgain">
          ğŸ”„ Jugar otra vez
        </button>
        <button class="btn large" id="toMenu">
          ğŸ“‹ Volver al menÃº
        </button>
      </div>
    </section>

    <!-- PANEL DE AJUSTES -->
    <aside id="settingsPanel" role="dialog" aria-labelledby="settingsTitle" style="display:none">
      <h3 id="settingsTitle">âš™ï¸ Ajustes</h3>
      
      <div class="settings-group">
        <div class="setting">
          <label for="volMaster">
            ğŸ”Š Volumen maestro
            <span id="volMasterVal" class="setting-value">80%</span>
          </label>
          <input 
            id="volMaster" 
            type="range" 
            min="0" 
            max="1" 
            step="0.01" 
            value="0.8"
            aria-valuemin="0"
            aria-valuemax="100"
            aria-valuenow="80">
        </div>
        
        <div class="setting">
          <label for="volEngine">
            ğŸï¸ Volumen motor
            <span id="volEngineVal" class="setting-value">80%</span>
          </label>
          <input 
            id="volEngine" 
            type="range" 
            min="0" 
            max="1" 
            step="0.01" 
            value="0.8"
            aria-valuemin="0"
            aria-valuemax="100"
            aria-valuenow="80">
        </div>
        
        <div class="setting">
          <label for="volSfx">
            ğŸ’¥ Volumen efectos
            <span id="volSfxVal" class="setting-value">90%</span>
          </label>
          <input 
            id="volSfx" 
            type="range" 
            min="0" 
            max="1" 
            step="0.01" 
            value="0.9"
            aria-valuemin="0"
            aria-valuemax="100"
            aria-valuenow="90">
        </div>
        

        <div class="setting">
          <label for="steeringMode">
            ğŸ® Suavizado de giro
          </label>
          <select id="steeringMode" class="setting-select">
            <option value="soft">Suave</option>
            <option value="normal" selected>Normal</option>
            <option value="direct">Directo</option>
          </select>
        </div>

        <div class="setting">
          <label for="nightLightBoost">
            ğŸŒ™ Intensidad farolas
            <span id="nightLightBoostVal" class="setting-value">120%</span>
          </label>
          <input
            id="nightLightBoost"
            type="range"
            min="0.8"
            max="2"
            step="0.1"
            value="1.2"
            aria-valuemin="80"
            aria-valuemax="200"
            aria-valuenow="120">
        </div>
      </div>
      
      <div class="settings-actions">
        <button class="btn" id="closeSettings">Cerrar</button>
      </div>
    </aside>

    <!-- Mensaje flotante en juego -->
    <div id="inGameMsg" role="status" aria-live="polite"></div>
  </div>

  <!-- Three.js y dependencias -->
  <script src="https://unpkg.com/three@0.152.2/build/three.min.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/loaders/GLTFLoader.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/postprocessing/EffectComposer.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/postprocessing/RenderPass.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/postprocessing/UnrealBloomPass.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/postprocessing/ShaderPass.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/shaders/FXAAShader.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/postprocessing/FilmPass.js"></script>
  
  <!-- AnimaciÃ³n de fondo del menÃº -->
  <script>
    // AnimaciÃ³n de partÃ­culas en el fondo del menÃº
    (function() {
      const canvas = document.getElementById('bgCanvas');
      if (!canvas) return;
      
      const ctx = canvas.getContext('2d');
      let particles = [];
      let w, h;

      function resize() {
        w = canvas.width = window.innerWidth;
        h = canvas.height = window.innerHeight;
      }

      class Particle {
        constructor() {
          this.x = Math.random() * w;
          this.y = Math.random() * h;
          this.vx = (Math.random() - 0.5) * 0.5;
          this.vy = (Math.random() - 0.5) * 0.5;
          this.size = Math.random() * 2 + 1;
          this.opacity = Math.random() * 0.5 + 0.2;
        }

        update() {
          this.x += this.vx;
          this.y += this.vy;

          if (this.x < 0 || this.x > w) this.vx *= -1;
          if (this.y < 0 || this.y > h) this.vy *= -1;
        }

        draw() {
          ctx.fillStyle = `rgba(29, 185, 84, ${this.opacity})`;
          ctx.beginPath();
          ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
          ctx.fill();
        }
      }

      function init() {
        resize();
        particles = [];
        for (let i = 0; i < 80; i++) {
          particles.push(new Particle());
        }
      }

      function animate() {
        ctx.fillStyle = 'rgba(10, 14, 20, 0.1)';
        ctx.fillRect(0, 0, w, h);

        particles.forEach(p => {
          p.update();
          p.draw();
        });

        // Conexiones entre partÃ­culas cercanas
        for (let i = 0; i < particles.length; i++) {
          for (let j = i + 1; j < particles.length; j++) {
            const dx = particles[i].x - particles[j].x;
            const dy = particles[i].y - particles[j].y;
            const dist = Math.sqrt(dx * dx + dy * dy);

            if (dist < 150) {
              ctx.strokeStyle = `rgba(29, 185, 84, ${0.2 * (1 - dist / 150)})`;
              ctx.lineWidth = 0.5;
              ctx.beginPath();
              ctx.moveTo(particles[i].x, particles[i].y);
              ctx.lineTo(particles[j].x, particles[j].y);
              ctx.stroke();
            }
          }
        }

        requestAnimationFrame(animate);
      }

      window.addEventListener('resize', resize);
      init();
      animate();
    })();
  </script>
  
  <!-- AplicaciÃ³n principal ULTRA -->
  <script src="app.js"></script>
</body>
</html>
