<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Car vs Zombies - Conduce, derrapa y esquiva hordas de zombies">
  <meta name="theme-color" content="#1a2a36">
  <title>Car vs Zombies â€“ Juego de AcciÃ³n Ultra</title>
  <link rel="stylesheet" href="slyles.css">
  <link rel="preconnect" href="https://unpkg.com">
</head>
<body>
  <div id="container" role="main">
    <!-- Fondo animado de partÃ­culas -->
    <canvas id="bgCanvas" class="bg-canvas"></canvas>
    
    <!-- HUD del juego -->
    <aside id="hud" aria-label="EstadÃ­sticas del juego">
      <div class="stat">
        <div><span class="label">FPS</span></div>
        <div id="fps" style="font-family: monospace;">60</div>
      </div>
      <div class="stat">
        <div><span class="label">PuntuaciÃ³n</span></div>
        <div id="score" aria-live="polite">0</div>
      </div>
      <div class="stat">
        <div><span class="label">Vida</span></div>
        <div id="hp" aria-live="polite">100</div>
      </div>
      <div class="stat">
        <div><span class="label">Velocidad</span></div>
        <div id="speed" aria-live="polite">0 km/h</div>
      </div>
      <div class="stat">
        <div><span class="label">Monedas</span></div>
        <div id="coins" aria-live="polite">0</div>
      </div>
      <div class="stat">
        <div><span class="label">Combo</span></div>
        <div id="combo" style="color: #ff6600; font-weight: bold; display: none;">x1</div>
      </div>
      <div class="stat">
        <div><span class="label">Oleada</span></div>
        <div id="wave">1</div>
      </div>
      <div class="stat" style="width: 100%; margin-top: 8px;">
        <div style="font-size: 11px; color: var(--muted); margin-bottom: 4px;">Nitro</div>
        <div style="width: 100%; height: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden;">
          <div id="nitroBar" style="width: 100%; height: 100%; background: linear-gradient(90deg, #ff6600, #ffdd00); transition: width 0.2s;"></div>
        </div>
      </div>
    </aside>

    <!-- Power-ups activos -->
    <div id="powerupContainer" style="position: absolute; left: 12px; top: 280px; z-index: 40; display: flex; flex-direction: column; gap: 8px;">
      <!-- Los power-ups activos aparecerÃ¡n aquÃ­ -->
    </div>

    <!-- Mini-mapa (Inferior Izquierda) -->
    <canvas id="minimap" width="160" height="160" 
            style="position: absolute; bottom: 12px; left: 12px; z-index: 45; 
                   border: 3px solid var(--accent); border-radius: 12px; 
                   background: rgba(10, 14, 20, 0.95); box-shadow: var(--shadow-lg);">
    </canvas>

    <!-- Controles superiores -->
    <nav id="topRight" aria-label="Controles del juego">
      <button class="btn" id="btnSettings" aria-label="Abrir ajustes">
        <span aria-hidden="true">âš™ï¸</span> Ajustes
      </button>
      <button class="btn primary" id="btnOpenMenu" aria-label="Abrir menÃº principal">
        ğŸ“‹ MenÃº
      </button>
      <button class="btn warn" id="btnRestart" style="display:none" aria-label="Reiniciar partida">
        ğŸ”„ Reiniciar
      </button>
    </nav>

    <!-- MENÃš PRINCIPAL MEJORADO -->
    <section id="overlayMenu" class="overlay hero-menu" role="dialog" aria-labelledby="menuTitle" aria-modal="true">
      <!-- Efecto de fondo con lÃ­neas de carretera -->
      <div class="road-lines"></div>
      
      <div class="hero-content">
        <!-- Logo del juego con efecto neÃ³n -->
        <div class="game-logo">
          <div class="logo-icon">ğŸš—</div>
          <h1 id="menuTitle" class="neon-text">
            CAR VS ZOMBIES
            <span class="ultra-badge">ULTRA</span>
          </h1>
          <p class="tagline">
            <span class="typing-text">Conduce, derrapa y sobrevive...</span>
          </p>
        </div>

        <!-- EstadÃ­sticas rÃ¡pidas -->
        <div class="quick-stats">
          <div class="stat-card">
            <div class="stat-icon">ğŸ†</div>
            <div class="stat-value" id="menuBestScore">0</div>
            <div class="stat-label">RÃ©cord</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">ğŸ’°</div>
            <div class="stat-value" id="menuCoins">0</div>
            <div class="stat-label">Monedas</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">ğŸ®</div>
            <div class="stat-value" id="menuGames">0</div>
            <div class="stat-label">Partidas</div>
          </div>
        </div>
        
        <!-- Botones principales con efectos -->
        <div class="menu-actions">
          <button class="btn-hero primary pulse" id="startBtn">
            <span class="btn-icon">â–¶ï¸</span>
            <span class="btn-text">EMPEZAR PARTIDA</span>
            <span class="btn-glow"></span>
          </button>
          
          <div class="menu-grid">
            <button class="btn-hero secondary" id="openShop">
              <span class="btn-icon">ğŸ›’</span>
              <span class="btn-text">Tienda</span>
            </button>
            <button class="btn-hero secondary" id="openZombieInfo">
              <span class="btn-icon">ğŸ§Ÿ</span>
              <span class="btn-text">Zombies</span>
            </button>
            <button class="btn-hero secondary" id="openLeaderboard">
              <span class="btn-icon">ğŸ†</span>
              <span class="btn-text">Records</span>
            </button>
            <button class="btn-hero secondary" id="openSettings">
              <span class="btn-icon">âš™ï¸</span>
              <span class="btn-text">Ajustes</span>
            </button>
          </div>
        </div>
        
        <!-- Controles compactos -->
        <div class="controls-compact">
          <div class="control-tip">
            <kbd>WASD</kbd> <span>Movimiento</span>
          </div>
          <div class="control-tip">
            <kbd>MOUSE</kbd> <span>DirecciÃ³n</span>
          </div>
          <div class="control-tip">
            <kbd>SHIFT</kbd> <span>Drift</span>
          </div>
          <div class="control-tip">
            <kbd>N</kbd> <span>Nitro</span>
          </div>
        </div>

        <!-- Footer con versiÃ³n -->
        <div class="menu-footer">
          <div class="version">Version ULTRA v2.0</div>
          <div class="credit">ğŸ® Mejor en Desktop â€¢ <kbd>F11</kbd> Pantalla Completa</div>
        </div>
      </div>
    </section>

    <!-- TIENDA DE COLORES Y MEJORAS -->
    <section id="overlayShop" class="overlay shop-overlay" style="display:none" role="dialog" aria-labelledby="shopTitle" aria-modal="true">
      <h1 id="shopTitle">ğŸ›’ Tienda & Mejoras</h1>
      
      <div class="shop-balance">
        <p>
          <strong>ğŸ’° Tus Monedas:</strong>
          <span id="shopCoinsDisplay" class="coins-amount">0</span>
        </p>
      </div>

      <h2 style="margin-top: 16px; font-size: 18px; color: var(--accent);">ğŸ¨ Colores</h2>
      <div id="shopGrid" class="shop-grid" role="list" aria-label="Colores disponibles">
        <!-- Los colores se generan dinÃ¡micamente aquÃ­ -->
      </div>

      <h2 style="margin-top: 24px; font-size: 18px; color: var(--accent);">â¬†ï¸ Mejoras Permanentes</h2>
      <p style="font-size: 13px; color: var(--muted); margin-bottom: 12px;">
        Las mejoras son permanentes y se aplican a todas tus partidas
      </p>
      <div id="upgradesGrid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 12px; margin: 16px 0;">
        <!-- Las mejoras se generan dinÃ¡micamente aquÃ­ -->
      </div>

      <div class="shop-actions">
        <button class="btn large" id="backFromShop">
          â—€ï¸ Volver al MenÃº
        </button>
      </div>
    </section>

    <!-- INFORMACIÃ“N DE ZOMBIES -->
    <section id="overlayZombieInfo" class="overlay" style="display:none; max-width: 700px;" role="dialog" aria-labelledby="zombieInfoTitle" aria-modal="true">
      <h1 id="zombieInfoTitle">ğŸ§Ÿ Tipos de Zombies</h1>
      
      <p style="color: var(--muted); font-size: 14px; margin-bottom: 20px;">
        Conoce a tus enemigos y sus caracterÃ­sticas
      </p>

      <div class="zombie-info-grid">
        <!-- Zombie Normal -->
        <div class="zombie-info-card" style="border-color: #2d5a2d;">
          <div class="zombie-icon" style="background: #2d5a2d;">ğŸ§Ÿ</div>
          <h3 style="color: #2d5a2d;">Zombie Normal</h3>
          <div class="zombie-stats">
            <div class="stat-row">
              <span class="stat-label">Velocidad:</span>
              <span class="stat-value">â­â­â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Vida:</span>
              <span class="stat-value">â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">DaÃ±o:</span>
              <span class="stat-value">12 HP</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Puntos:</span>
              <span class="stat-value">10 pts</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Monedas:</span>
              <span class="stat-value">ğŸ’° 1</span>
            </div>
          </div>
          <p class="zombie-desc">
            El zombie estÃ¡ndar. Velocidad y daÃ±o moderados. Perfecto para practicar combos.
          </p>
        </div>

        <!-- Zombie RÃ¡pido -->
        <div class="zombie-info-card" style="border-color: #ff6600;">
          <div class="zombie-icon" style="background: #ff6600;">ğŸ§Ÿâ€â™‚ï¸</div>
          <h3 style="color: #ff6600;">Zombie RÃ¡pido</h3>
          <div class="zombie-stats">
            <div class="stat-row">
              <span class="stat-label">Velocidad:</span>
              <span class="stat-value">â­â­â­â­â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Vida:</span>
              <span class="stat-value">â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">DaÃ±o:</span>
              <span class="stat-value">8 HP</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Puntos:</span>
              <span class="stat-value">20 pts</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Monedas:</span>
              <span class="stat-value">ğŸ’° 2</span>
            </div>
          </div>
          <p class="zombie-desc">
            Muy rÃ¡pido pero frÃ¡gil. DifÃ­cil de alcanzar, pero vale mÃ¡s puntos.
          </p>
        </div>

        <!-- Zombie Tanque -->
        <div class="zombie-info-card" style="border-color: #8b0000;">
          <div class="zombie-icon" style="background: #8b0000;">ğŸ§Ÿâ€â™€ï¸</div>
          <h3 style="color: #8b0000;">Zombie Tanque</h3>
          <div class="zombie-stats">
            <div class="stat-row">
              <span class="stat-label">Velocidad:</span>
              <span class="stat-value">â­â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Vida:</span>
              <span class="stat-value">â­â­â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">DaÃ±o:</span>
              <span class="stat-value">25 HP</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Puntos:</span>
              <span class="stat-value">50 pts</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Monedas:</span>
              <span class="stat-value">ğŸ’° 5</span>
            </div>
          </div>
          <p class="zombie-desc">
            <strong>Â¡PELIGROSO!</strong> Lento pero resistente. Necesita 3 golpes para morir. Hace mucho daÃ±o.
          </p>
        </div>

        <!-- Zombie Explosivo -->
        <div class="zombie-info-card" style="border-color: #ffff00;">
          <div class="zombie-icon" style="background: #ffff00; color: #000;">ğŸ’£</div>
          <h3 style="color: #ffff00;">Zombie Explosivo</h3>
          <div class="zombie-stats">
            <div class="stat-row">
              <span class="stat-label">Velocidad:</span>
              <span class="stat-value">â­â­â­â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Vida:</span>
              <span class="stat-value">â­</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">DaÃ±o:</span>
              <span class="stat-value">30 HP</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Puntos:</span>
              <span class="stat-value">40 pts</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Monedas:</span>
              <span class="stat-value">ğŸ’° 3</span>
            </div>
          </div>
          <p class="zombie-desc">
            <strong>âš ï¸ Â¡CUIDADO!</strong> Explota al morir o al chocar. MantÃ©n tu distancia o usa el escudo.
          </p>
        </div>
      </div>

      <div class="zombie-tips">
        <h3>ğŸ’¡ Consejos de Combate</h3>
        <ul>
          <li><strong>Zombies Normales:</strong> Ãšsalos para mantener tu combo alto</li>
          <li><strong>Zombies RÃ¡pidos:</strong> Prioriza esquivarlos, valen muchos puntos</li>
          <li><strong>Zombies Tanque:</strong> Usa el arma o evÃ­talos si no tienes escudo</li>
          <li><strong>Zombies Explosivos:</strong> Â¡NUNCA los mates de frente! Usa el arma desde lejos</li>
        </ul>
      </div>

      <div class="shop-actions">
        <button class="btn large" id="backFromZombieInfo">
          â—€ï¸ Volver al MenÃº
        </button>
      </div>
    </section>

    <!-- TABLA DE CLASIFICACIÃ“N -->
    <section id="overlayLeaderboard" class="overlay" style="display:none; max-width: 600px;" role="dialog" aria-labelledby="leaderboardTitle" aria-modal="true">
      <h1 id="leaderboardTitle">ğŸ† Tabla de ClasificaciÃ³n</h1>
      
      <p style="color: var(--muted); font-size: 14px; margin-bottom: 20px;">
        Top 10 mejores puntuaciones
      </p>

      <div id="leaderboardContent" style="min-height: 300px;">
        <!-- Las entradas se generan dinÃ¡micamente -->
      </div>

      <div class="shop-actions">
        <button class="btn large" id="backFromLeaderboard">
          â—€ï¸ Volver al MenÃº
        </button>
      </div>
    </section>

    <!-- GAME OVER -->
    <section id="overlayGameOver" class="overlay" style="display:none" role="dialog" aria-labelledby="goTitle" aria-modal="true">
      <h1 id="goTitle">Game Over</h1>
      
      <div class="game-over-stats">
        <p class="final-score">
          PuntuaciÃ³n final: <strong id="goScore">0</strong>
        </p>
        <p class="coins-earned">
          ğŸ’° Monedas ganadas: <strong id="goCoins">0</strong>
        </p>
        <p style="color: var(--muted); font-size: 14px;">
          ğŸ¯ Kills totales: <strong id="goKills" style="color: #ff6600;">0</strong>
        </p>
        <p style="color: var(--muted); font-size: 14px;">
          ğŸ”¥ Combo mÃ¡ximo: <strong id="goMaxCombo" style="color: #ff6600;">x1</strong>
        </p>
      </div>
      
      <div class="game-over-actions">
        <button class="btn primary large" id="playAgain">
          ğŸ”„ Jugar otra vez
        </button>
        <button class="btn large" id="toMenu">
          ğŸ“‹ Volver al menÃº
        </button>
      </div>
    </section>

    <!-- PANEL DE AJUSTES -->
    <aside id="settingsPanel" role="dialog" aria-labelledby="settingsTitle" style="display:none">
      <h3 id="settingsTitle">âš™ï¸ Ajustes</h3>
      
      <div class="settings-group">
        <div class="setting">
          <label for="volMaster">
            ğŸ”Š Volumen maestro
            <span id="volMasterVal" class="setting-value">80%</span>
          </label>
          <input 
            id="volMaster" 
            type="range" 
            min="0" 
            max="1" 
            step="0.01" 
            value="0.8"
            aria-valuemin="0"
            aria-valuemax="100"
            aria-valuenow="80">
        </div>
        
        <div class="setting">
          <label for="volEngine">
            ğŸï¸ Volumen motor
            <span id="volEngineVal" class="setting-value">80%</span>
          </label>
          <input 
            id="volEngine" 
            type="range" 
            min="0" 
            max="1" 
            step="0.01" 
            value="0.8"
            aria-valuemin="0"
            aria-valuemax="100"
            aria-valuenow="80">
        </div>
        
        <div class="setting">
          <label for="volSfx">
            ğŸ’¥ Volumen efectos
            <span id="volSfxVal" class="setting-value">90%</span>
          </label>
          <input 
            id="volSfx" 
            type="range" 
            min="0" 
            max="1" 
            step="0.01" 
            value="0.9"
            aria-valuemin="0"
            aria-valuemax="100"
            aria-valuenow="90">
        </div>
        
        <div class="setting">
          <label for="mouseSensitivity">
            ğŸ–±ï¸ Sensibilidad del ratÃ³n
            <span id="mouseSensitivityVal" class="setting-value">100%</span>
          </label>
          <input 
            id="mouseSensitivity" 
            type="range" 
            min="0.1" 
            max="2" 
            step="0.1" 
            value="1"
            aria-valuemin="10"
            aria-valuemax="200"
            aria-valuenow="100">
        </div>
      </div>
      
      <div class="settings-actions">
        <button class="btn" id="closeSettings">Cerrar</button>
      </div>
    </aside>

    <!-- Mensaje flotante en juego -->
    <div id="inGameMsg" role="status" aria-live="polite"></div>
  </div>

  <!-- Three.js y dependencias -->
  <script src="https://unpkg.com/three@0.152.2/build/three.min.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/loaders/GLTFLoader.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/postprocessing/EffectComposer.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/postprocessing/RenderPass.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/postprocessing/UnrealBloomPass.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/postprocessing/ShaderPass.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/shaders/FXAAShader.js"></script>
  <script src="https://unpkg.com/three@0.152.2/examples/js/postprocessing/FilmPass.js"></script>
  
  <!-- AnimaciÃ³n de fondo del menÃº -->
  <script>
    // AnimaciÃ³n de partÃ­culas en el fondo del menÃº
    (function() {
      const canvas = document.getElementById('bgCanvas');
      if (!canvas) return;
      
      const ctx = canvas.getContext('2d');
      let particles = [];
      let w, h;

      function resize() {
        w = canvas.width = window.innerWidth;
        h = canvas.height = window.innerHeight;
      }

      class Particle {
        constructor() {
          this.x = Math.random() * w;
          this.y = Math.random() * h;
          this.vx = (Math.random() - 0.5) * 0.5;
          this.vy = (Math.random() - 0.5) * 0.5;
          this.size = Math.random() * 2 + 1;
          this.opacity = Math.random() * 0.5 + 0.2;
        }

        update() {
          this.x += this.vx;
          this.y += this.vy;

          if (this.x < 0 || this.x > w) this.vx *= -1;
          if (this.y < 0 || this.y > h) this.vy *= -1;
        }

        draw() {
          ctx.fillStyle = `rgba(29, 185, 84, ${this.opacity})`;
          ctx.beginPath();
          ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
          ctx.fill();
        }
      }

      function init() {
        resize();
        particles = [];
        for (let i = 0; i < 80; i++) {
          particles.push(new Particle());
        }
      }

      function animate() {
        ctx.fillStyle = 'rgba(10, 14, 20, 0.1)';
        ctx.fillRect(0, 0, w, h);

        particles.forEach(p => {
          p.update();
          p.draw();
        });

        // Conexiones entre partÃ­culas cercanas
        for (let i = 0; i < particles.length; i++) {
          for (let j = i + 1; j < particles.length; j++) {
            const dx = particles[i].x - particles[j].x;
            const dy = particles[i].y - particles[j].y;
            const dist = Math.sqrt(dx * dx + dy * dy);

            if (dist < 150) {
              ctx.strokeStyle = `rgba(29, 185, 84, ${0.2 * (1 - dist / 150)})`;
              ctx.lineWidth = 0.5;
              ctx.beginPath();
              ctx.moveTo(particles[i].x, particles[i].y);
              ctx.lineTo(particles[j].x, particles[j].y);
              ctx.stroke();
            }
          }
        }

        requestAnimationFrame(animate);
      }

      window.addEventListener('resize', resize);
      init();
      animate();
    })();
  </script>
  
  <!-- AplicaciÃ³n principal ULTRA -->
  <script src="app.js"></script>
</body>
</html>